{% extends "layouts/base.html" %}

{% block title %} Dashboard{% endblock %}

<!-- Specific Page CSS goes HERE  -->
{% block stylesheets %}

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/all.min.css">

<style>
 #redes_sociales {
      display: flex;
      flex-direction: column;
      align-items: center;
      padding: 0;
      margin: 4px;
    }
  
    #redes_sociales .list-inline-item {
      margin: 0;
      width: 100%;
      text-align: center;
    }
  
    #redes_sociales .btn {
      border-radius: 0;
      border: none;
      box-shadow: none;
      width: 100%;
    }
  
    #redes_sociales .btn:focus {
      box-shadow: none;
    }

    #redes_sociales ul {
      width: 100px; /* Ancho fijo para la lista */
      background-color: #f8f9fa; /* Color de fondo */
      padding: 10px;
      margin: 0;
      display: flex;
      flex-direction: column;
      align-items: center;
    }

</style>
{% endblock stylesheets %}
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/5.3.0/css/bootstrap.min.css">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/5.3.0/js/bootstrap.bundle.min.js"></script>

{% block content %}
<section class="mb-4 bg-white">
<div class="container mt-4">
  <div class="row">
      <div class="col-md-8 mx-auto">
          <section class="mb-4">
              <div class="card m-1">
                  <div class="card-body">
                      <h2 class="h1-responsive font-weight-bold text-center my-4">Contactanos</h2>
                      <p class="text-center w-responsive mx-auto mb-5">¿Tiene usted alguna pregunta? Por favor, no dude en contactarnos directamente. Nuestro equipo le responderá dentro de unas horas para ayudarle.</p>
                      <div class="row">
                          <div class="col-md-9 mb-md-0 mb-5">
                          <form class="row g-3 needs-validation" novalidate id="formulario_contacto" name="formulario_contacto">
                                {% comment %} <form class="needs-validation p-2" novalidate id="formulario_contacto" name="formulario_contacto" method="POST"> {% endcomment %}
                                    {% csrf_token %}
                                    <div class="row">
                                        <div class="col-md-6">
                                            <div class="md-form mb-0">
                                                <label for="nombre">Nombre</label>
                                                <input type="text" id="nombre" name="nombre" class="form-control" required>
                                            </div>
                                        </div>
                                        <div class="col-md-6">
                                            <div class="md-form mb-0">
                                                <label for="numero_celular">Numero de Celular</label>
                                                <input type="number" id="numero_celular" name="numero_celular" class="form-control" required>
                                            </div>                                            
                                        </div>
                                    </div>
                                    <div class="row mt-2">
                                        <div class="col-md-12">
                                            <div class="md-form mb-0">
                                                <label for="email">Email</label>
                                                <input type="email" id="email" name="email" class="form-control" required>
                                                <div class="invalid-feedback">
                                                    Por favor ingresa un correo valido
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="row mt-2">
                                        <div class="col-md-12">
                                            <div class="md-form mb-0">
                                                <label for="asunto">Asunto</label>
                                                <input type="text" id="asunto" name="asunto" class="form-control" required>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="row mt-2">
                                        <div class="col-md-12">
                                            <div class="md-form">
                                                <label for="mensaje">Mensaje</label>
                                                <textarea type="text" id="mensaje" name="mensaje" rows="2" class="form-control md-textarea" required></textarea>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="text-center text-md-left p-2">
                                        <!-- Utiliza un botón en lugar de un enlace para el envío del formulario -->
                                        <button type="submit" class="btn btn-success">Enviar</button>
                                        {% comment %} <button type="submit" id="finalizar"  class="btn btn-secondary mt-2">Guardar Cambios</button> {% endcomment %}
                                    </div>
                                </form>
                              <div class="status"></div>
                          </div>
                          <div class="col-md-3 text-center">
                              <ul class="list-unstyled mb-0">
                                  <li><i class="fas fa-map-marker-alt fa-2x"></i>
                                      <p>Perif. Blvd. Manuel Ávila Camacho 80-int 204, El Parque, 53398 Naucalpan de Juárez, Méx</p>
                                  </li>
                                  <li><i class="fas fa-phone mt-4 fa-2x"></i>
                                      <p>55 7258 9136</p>
                                  </li>
                                  <li><i class="fas fa-envelope mt-4 fa-2x"></i>
                                      <p>polanco@arrendify.com</p>
                                  </li>
                              </ul>
                          </div>
                      </div>
                  </div>
              </div>
          </section>
      </div>
  </div>
</div>
</section>
{% endblock content %}

<!-- Specific Page JS goes HERE  -->
{% block javascripts %}
<script src="/static/assets/repositorios/loader.js"></script>
<script src="https://cdn.jsdelivr.net/npm/axios/dist/axios.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/@popperjs/core@2.9.1/dist/umd/popper.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>

<script>
    {% comment %} document.getElementById("li2").onload = inicio()
    function inicio(){
         console.log("entro inicio")
        auten()
    } {% endcomment %}
    (function () {
  'use strict'

  // Fetch all the forms we want to apply custom Bootstrap validation styles to
  var forms = document.querySelectorAll('.needs-validation')

  // Loop over them and prevent submission
  Array.prototype.slice.call(forms)
    .forEach(function (form) {
      form.addEventListener('submit', function (event) {
        if (!form.checkValidity()) {
          event.preventDefault()
          event.stopPropagation()
        }

        form.classList.add('was-validated')
      }, false)
    })
})()

    const server = 'http://192.168.2.14:8001'
    const configin = {
        headers: {
          'Content-Type': 'application/json',
          'Accept': 'application/json',
          'Authorization': `Token ${localStorage.getItem('token')}`
        },
      }; 


    const submit = document.getElementById("formulario_contacto");
    submit.addEventListener("submit", function(event){
        event.preventDefault();
        if (submit.checkValidity()){
            const datos = {
                "nombre": document.getElementById("nombre").value,
                "email": document.getElementById("email").value,
                "numero_celular": document.getElementById("numero_celular").value,
                "asunto": document.getElementById("asunto").value,
                "mensaje": document.getElementById("mensaje").value
            }
            enviarDatosContacto(datos);
        }else{
            console.log("Completa los campos")
        }
        
        console.log("Envio datos")
        //enviarDatosContacto(datos);

    });

    const enviarDatosContacto = async (datos) =>{
        try{
            console.log("Llego a datos")
            const response = await axios.post(`${server}/ContactoDatos/`, datos, configin);
            console.log(response.data); 
            Swal.fire({
                    icon: 'success',
                    title: '¡Contraseña editada correctamente!',
                    text: 'Se edito de forma correcta.',
                    showConfirmButton: false,
                    timer: 1300
                }).then(() => {
                    submit.reset();
                    location.reload();
                });       
        }catch(error){
            console.log(error)
        }
    }
   
</script>

{% endblock javascripts %}
